app.controller("ProductCtrl",["$scope","$http","productsCRUD","$upload","identity",function(e,r,t,o,d){var a=[];e.imageExist=false;var n={name:"",productModel:"",maker:"",origin:"",reseller:{name:"",town:"",price:"",dateBought:""}};e.product=n;e.proscon="";e.conscon="";e.error="No file is selected!";e.removeImage=function(){e.imageExist=false;e.error="No file is selected!";e.product.filedata=""};e.onFileSelect=function(r){a=r;var t=r[0];var o=true;if(t.type.indexOf("image")==-1){e.error="image extension not allowed, please choose a JPEG or PNG file.";o=false}if(t.size>5e6){e.error="File size cannot exceed 5 MB!";o=false}if(o){e.error="File OK and ready for uploading!";e.product.filename=t.name;e.imageExist=true;e.error="Selected file name is :  "+t.name}};e.addProduct=function(r){if(e.imageExist){if(confirm("Are you sure you want to save this thing into the database?")){if(!!e.product.name){var t={name:e.product.name,productModel:e.product.productModel||"--",maker:e.product.maker||"--",origin:e.product.origin||"--",reseller:{name:e.product.reseller.name||"--",town:e.product.reseller.town||"--",price:e.product.reseller.price||"--",dateBought:e.product.reseller.dateBought||"--"},pros:[{userAdded:d.currentUser.username,dateAdded:new Date,content:e.proscon||"--",flagIsNew:true}],cons:[{userAdded:d.currentUser.username,dateAdded:new Date,content:e.conscon||"--",flagIsNew:true}],id:99,userAdded:d.currentUser.username,dateAdded:new Date,flagIsNew:true,flagNewCommentAdded:true,picture:[{filename:e.product.filename,dateAdded:new Date,userAdded:d.currentUser.username}],keyWords:["n/a"],category:["n/a"]};o.upload({url:"/upload_image",file:a[0],data:t,progress:function(e){}}).then(function(e,r,t,o){});e.product.name="";e.product.productModel="";e.product.maker="";e.product.origin="";e.product.reseller.name="";e.product.reseller.town="";e.product.reseller.price="";e.product.reseller.dateBought="";e.proscon="";e.conscon="";e.imageExist=false;e.error="No file is selected!";alert("Product created!")}else{alert("Write some name!")}}}else{if(confirm("Are you sure you want to save this thing into the database?")){if(!!e.product.name){var t={name:e.product.name,productModel:e.product.productModel||"--",maker:e.product.maker||"--",origin:e.product.origin||"--",reseller:{name:e.product.reseller.name||"--",town:e.product.reseller.town||"--",price:e.product.reseller.price||"--",dateBought:e.product.reseller.dateBought||"--"},pros:[{userAdded:d.currentUser.username,dateAdded:new Date,content:e.proscon||"--",flagIsNew:true}],cons:[{userAdded:d.currentUser.username,dateAdded:new Date,content:e.conscon||"--",flagIsNew:true}],picture:[{filename:"noPicture",dateAdded:new Date,userAdded:d.currentUser.username}],id:99,userAdded:d.currentUser.username,dateAdded:new Date,flagIsNew:true,flagNewCommentAdded:true,keyWords:["n/a"],category:["n/a"]};o.upload({url:"/upload_image",data:t,progress:function(e){}}).then(function(e,r,t,o){});e.product.name="";e.product.productModel="";e.product.maker="";e.product.origin="";e.product.reseller.name="";e.product.reseller.town="";e.product.reseller.price="";e.product.reseller.dateBought="";e.proscon="";e.conscon="";e.imageExist=false;e.error="No file is selected!";alert("Product created!")}else{alert("Write some name!")}}}}}]);