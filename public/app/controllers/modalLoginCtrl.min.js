app.controller("ModalLoginCtrl",["$scope","$modalInstance","auth",function(e,s,r){e.user={username:"",password:""};e.closeMe=function(){s.dismiss("cancel")};e.valid=function(){e.proppername="";e.propperpass="";if(e.user.username!==e.user.username.replace(/[^a-zA-Z0-9а-яА-Я.]/g,"")){e.user.username=e.user.username.replace(/[^a-zA-Z0-9а-яА-Я.]/g,"");e.proppername="Моля, използвайте само големи или малки букви (a-z)(а-я), цифри и точки!"}if(e.user.password!==e.user.password.replace(/[^a-zA-Z0-9а-яА-Я.]/g,"")){e.user.password=e.user.password.replace(/[^a-zA-Z0-9а-яА-Я.]/g,"");e.propperpass="Моля, използвайте само големи или малки букви (a-z)(а-я), цифри и точки!"}};e.ent=function(){if(e.user.username.length>0&&e.user.password.length>0){e.ok();return}if(e.user.username.length>0){angular.element("#password").focus();e.propperpass="Моля, въведете парола си!";return}if(e.user.password.length>0){angular.element("#username").focus()}e.proppername="Моля, въведете потребителското си име!"};e.forgottenPass=function(){s.close("s")};e.ok=function(){if(e.user){if(!e.user.username){e.proppername="Моля, въведете потребителското си име!";angular.element("#username").focus();return}if(!e.user.password){e.propperpass="Моля, въведете парола си!";angular.element("#password").focus();return}r.login(e.user).then(function(r){if(r.data.success){s.close(r.data.user)}else{e.user.password="";e.proppername="Сгрешили сте паролата или потребителското си име!";angular.element("#username").focus()}},function(e){console.log("something wrong: "+e)})}};e.cancel=function(){s.dismiss("cancel")};e.signUp=function(){s.close("signUp")}}]);