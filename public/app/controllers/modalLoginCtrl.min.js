app.controller("ModalLoginCtrl",["$scope","$modalInstance","auth",function(e,r,s){e.user={username:"",password:""};e.valid=function(){e.proppername="";e.propperpass="";if(e.user.username!==e.user.username.replace(/[^a-zA-Z0-9.]/g,"")){e.user.username=e.user.username.replace(/[^a-zA-Z0-9.]/g,"");e.proppername="Моля, използвайте само букви (a-z), цифри и точки."}if(e.user.password!==e.user.password.replace(/[^a-zA-Z0-9.]/g,"")){e.user.password=e.user.password.replace(/[^a-zA-Z0-9.]/g,"");e.propperpass="Моля, използвайте само букви (a-z), цифри и точки."}document.getElementById("redAlert").innerHTML=""};e.ent=function(){if(e.user.username.length>0&&e.user.password.length>0){e.ok();return}if(e.user.username.length>0){angular.element("#password").focus();e.propperpass="Моля, въведете парола си!";return}if(e.user.password.length>0){if(document.getElementById("username")){angular.element("#username").focus()}e.proppername="Моля, въведете потребителското си име!"}};e.forgottenPass=function(){r.close("s")};e.ok=function(){if(e.user){if(!e.user.username){e.proppername="Моля, въведете потребителското си име!";angular.element("#username").focus();return}if(!e.user.password){e.propperpass="Моля, въведете парола си!";angular.element("#password").focus();return}s.login(e.user).then(function(s){if(s.data.success){r.close(s.data.user)}else{e.user.username="";e.user.password="";document.getElementById("redAlert").innerHTML="Сгрешили сте паролата или името си!";angular.element("#username").focus()}},function(e){console.log("something wrong: "+e)})}};e.cancel=function(){r.dismiss("cancel")};e.signUp=function(){r.close("signUp")}}]);