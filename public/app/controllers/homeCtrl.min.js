app.controller("HomeCtrl",["$scope","$resource","$http","$q","identity",function(e,r,t,c,n){e.identity=n;var s=$('meta[name="viewport"]');$("input, select, textarea").bind("focus blur",function(e){s.attr("content","width=device-width,initial-scale=1,maximum-scale="+(e.type=="blur"?10:1))});e.searchBuffer=[];e.enterIntoInput=function(){t.get("/api/search",{params:{search:e.search.trim()}}).success(function(r,t,c,n){e.searchBuffer=r}).error(function(e){console.log("Resource reading failed: "+e)})};function a(e){var t=r("/api/search");return t.query({search:e})}e.select=function(r){e.searchBuffer=[];e.search=r;e.goSearch()};$("body").keyup(function(r){if(event.keyCode==13){if(e.searchBuffer.length>0){e.searchBuffer=[];e.goSearch()}}if(event.keyCode==9){if(e.searchBuffer.length>0){e.search=e.searchBuffer[0];e.searchBuffer=[];e.goSearch()}}});e.search="";var i=0;e.step=6;function o(e,t,c){var n=r("/api");return n.query({s:e,l:t,search:c})}e.products=o(i,e.step,e.search);e.goSearch=function(){e.search=e.search.trim();t.get("/api",{params:{s:i,l:e.step,search:e.search}}).success(function(r,t,c,n){e.products=r}).error(function(e){console.log("Resource reading failed: "+e)})};e.getNumber=function(e){var r=0;e.forEach(function(e){if(!e.flagIsNew){r++}});return r};e.prev=function(){if(i>=e.step){i=i-e.step;o(i,e.step,e.search).$promise.then(function(r){e.products=r})}};e.next=function(){i=i+e.step;o(i,e.step,e.search).$promise.then(function(r){if(r.length===0){i=i-e.step}else{e.products=r}})}}]);