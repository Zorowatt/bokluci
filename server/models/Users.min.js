var mongoose=require("mongoose"),crypto=require("crypto");var userSchema=mongoose.Schema({username:{type:String,require:"{PATH} is required",unique:true},email:{type:String,require:"{PATH} is required",unique:true},firstName:{type:String,require:"{PATH} is required"},lastName:String,salt:String,hashPass:String,roles:[String],host:String,confirmedEmail:Boolean,randomIdForEmailConfirmation:{type:String,unique:true},expirationConfirmationTime:Date,userIP:String});userSchema.method({authenticate:function(e){if(generateHashedPassword(this.salt,e)===this.hashPass){return true}else{return false}}});var user=mongoose.model("Users",userSchema);function generateHashedPassword(e,r){var t=crypto.createHmac("sha1",e);return t.update(r).digest("hex")}